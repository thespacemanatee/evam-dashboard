import React from 'react';
import { StyleProp, View, ViewStyle } from 'react-native';
import Animated, {
  interpolate,
  useAnimatedProps,
} from 'react-native-reanimated';
import Svg, { Path, Rect, Defs, LinearGradient, Stop } from 'react-native-svg';

import { FINAL_TACHOMETER_HEIGHT } from '../../utils/config';

const AnimatedRect = Animated.createAnimatedComponent(Rect);

interface LeftTachometerProps {
  progress: Animated.SharedValue<number>;
  style?: StyleProp<ViewStyle>;
}

const LeftTachometer: React.FC<LeftTachometerProps> = ({ progress, style }) => {
  const animatedProps = useAnimatedProps(() => {
    return {
      height: interpolate(progress.value, [0, 100], [840, 0]),
    };
  });
  return (
    <View style={style}>
      <Svg
        width={FINAL_TACHOMETER_HEIGHT * 0.66325}
        height={FINAL_TACHOMETER_HEIGHT}
        viewBox="0 0 565 851"
        fill="none">
        <Path
          d="M405.227 842.83V808.471H418.117C420.742 808.471 422.844 808.822 424.422 809.525C426.016 810.213 427.258 811.283 428.149 812.736C429.055 814.174 429.508 815.682 429.508 817.26C429.508 818.729 429.109 820.111 428.313 821.408C427.516 822.705 426.313 823.752 424.703 824.549C426.781 825.158 428.375 826.197 429.484 827.666C430.609 829.135 431.172 830.869 431.172 832.869C431.172 834.479 430.828 835.979 430.141 837.369C429.469 838.744 428.633 839.807 427.633 840.557C426.633 841.307 425.375 841.877 423.859 842.268C422.359 842.643 420.516 842.83 418.328 842.83H405.227ZM409.774 822.908H417.203C419.219 822.908 420.664 822.775 421.539 822.51C422.695 822.166 423.563 821.596 424.141 820.799C424.734 820.002 425.031 819.002 425.031 817.799C425.031 816.658 424.758 815.658 424.211 814.799C423.664 813.924 422.883 813.33 421.867 813.018C420.852 812.689 419.109 812.525 416.641 812.525H409.774V822.908ZM409.774 838.775H418.328C419.797 838.775 420.828 838.721 421.422 838.611C422.469 838.424 423.344 838.111 424.047 837.674C424.75 837.236 425.328 836.604 425.781 835.775C426.234 834.932 426.461 833.963 426.461 832.869C426.461 831.588 426.133 830.479 425.477 829.541C424.82 828.588 423.906 827.924 422.734 827.549C421.578 827.158 419.906 826.963 417.719 826.963H409.774V838.775ZM437.5 842.83V808.471H452.734C455.797 808.471 458.125 808.783 459.719 809.408C461.313 810.018 462.586 811.104 463.539 812.666C464.492 814.229 464.969 815.955 464.969 817.846C464.969 820.283 464.18 822.338 462.602 824.01C461.024 825.682 458.586 826.744 455.289 827.197C456.492 827.775 457.406 828.346 458.031 828.908C459.359 830.127 460.617 831.65 461.805 833.479L467.781 842.83H462.063L457.516 835.682C456.188 833.619 455.094 832.041 454.234 830.947C453.375 829.854 452.602 829.088 451.914 828.65C451.242 828.213 450.555 827.908 449.852 827.736C449.336 827.627 448.492 827.572 447.32 827.572H442.047V842.83H437.5ZM442.047 823.635H451.82C453.899 823.635 455.524 823.424 456.695 823.002C457.867 822.564 458.758 821.877 459.367 820.939C459.977 819.986 460.281 818.955 460.281 817.846C460.281 816.221 459.688 814.885 458.5 813.838C457.328 812.791 455.469 812.268 452.922 812.268H442.047V823.635ZM468.344 842.83L481.539 808.471H486.438L500.5 842.83H495.32L491.313 832.424H476.945L473.172 842.83H468.344ZM478.258 828.721H489.906L486.32 819.205C485.227 816.314 484.414 813.939 483.883 812.08C483.445 814.283 482.828 816.471 482.031 818.643L478.258 828.721ZM503.945 842.83V808.471H508.492V825.51L525.555 808.471H531.719L517.305 822.393L532.352 842.83H526.352L514.117 825.439L508.492 830.924V842.83H503.945ZM536.242 842.83V808.471H561.086V812.525H540.789V823.049H559.797V827.08H540.789V838.775H561.883V842.83H536.242Z"
          fill="white"
        />
        <Path d="M239.424 850H565" stroke="white" strokeWidth={2} />
        <Path
          d="M202.5 486.845L299.5 840L234.5 840L0.566443 -1.31608e-05L202.5 -4.27051e-06C202.5 -4.27051e-06 185 40.8169 162 149.07C139 257.324 202.5 486.845 202.5 486.845Z"
          fill="url(#paint0_linear)"
        />
        <AnimatedRect
          opacity={0.8}
          x={0.0000305176}
          width={300}
          animatedProps={animatedProps}
          fill="black"
        />
        <Defs>
          <LinearGradient
            id="paint0_linear"
            x1={0.000147511}
            y1={840}
            x2={0.000168013}
            y2={-0.000019372}
            gradientUnits="userSpaceOnUse">
            <Stop stopColor="#00C2FF" />
            <Stop offset={0.440625} stopColor="#AFE550" />
            <Stop offset={0.794792} stopColor="#FFF500" />
            <Stop offset={1} stopColor="#FF0000" />
          </LinearGradient>
        </Defs>
      </Svg>
    </View>
  );
};

LeftTachometer.defaultProps = {
  style: undefined,
};

export default LeftTachometer;
